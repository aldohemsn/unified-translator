# 学术翻译助手模块 (AcademicStrategy) 流程与逻辑详解

学术翻译助手模块 (`AcademicStrategy`) 的核心目标是模拟“**直译 + 润色**”的双重专家工作流，以生成兼具准确性和学术严谨性的译文。其流程主要分为**初始化分析**、**分批处理**和**质量控制**三个阶段。

## 1. 初始化分析 (Setup Phase)

在正式翻译前，模块会对原文前 ~60 行（约 8000 字符）进行深度分析：

*   **双重人设生成 (Dual-Persona Generation)**：通过 LLM 分析原文的学科领域（Academic Field）、语体（Register）、受众和作者立场，动态定制两个 Agent 人设：
    *   **直译专家 (Literal Translator)**：专注于结构准确性和语义锚定，被指令抑制润色冲动，产出透明的语义底稿。
    *   **学术编辑 (Academic Editor)**：专注于出版级的语言流畅度和学术规范，负责将直译稿打磨成地道的学术英语。
*   **术语提取 (Term Extraction)**：识别原文中最高频的 20 个技术术语，并标准化其译名，确保全文术语一致性。
*   **语义分块 (Semantic Segmentation)**：基于语义逻辑将文档划分为若干“语义段”（Semantic Segments/Paragraphs），通常每段 10-25 行。这避免了物理分批（如固定 15 行）切断上下文逻辑。

## 2. 分批翻译处理 (Batch Processing)

模块按语义分块进行批次处理，核心逻辑包括：

*   **上下文注入**：为每个批次注入**术语表**和**上文语境**（上一批次的译文片段），确保语义连贯。
*   **双阶段生成**：在一个 Prompt 中同时驱动两个人设。Phase 1 输出直译，Phase 2 输出润色稿，最终仅保留润色后的 Target。
*   **跨行合并协议 (Cross-Row Merging)**：
    *   处理因排版导致的跨行断句问题。
    *   逻辑允许将断句向上或向下合并，并在对应行填入占位符 `[已向上合并]` 或 `[已向下合并]`。
    *   **关键约束**：严格保持输入/输出行数不变（Row Count Invariance），确保与原文行行对应。

## 3. 质量控制 (QA Check)

如果配置启用，会进行后处理 QA 检查：

*   **错误侦测**：通过单独的 LLM 调用，对比原文和译文。
*   **红线标准**：仅标记**重大事实错误**（遗漏 Omissions、误解 Misinterpretations、幻觉 Hallucinations）。
*   **忽略项**：自动忽略风格调整、可以接受的重述或标点变化。
*   **标记**：发现严重问题时，会在译文中追加 `[[QA FLAG: ...]]` 标记供人工复查。
